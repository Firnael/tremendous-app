<!-- Roster page -->
<!-- Sidebar -->
<trmds-side-bar page="roster"></trmds-side-bar>

<div class="rows-wrapper" ng-class="$root.open">

<trmds-title-bar page="Roster" updating="vm.updating" last-update="vm.rosterInfos.lastUpdate" update="vm.updateRoster">
</trmds-title-bar>

<!-- Update progress -->
<div class="row text-center" ng-show="vm.updating === true && vm.rosterSize > 0">
  <div class="col-md-offset-4 col-md-4 text-center">
    <h2>Updating roster</h2>
    <div class="progress">
      <div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="45" aria-valuemin="0" aria-valuemax="100" ng-style="{ 'width': vm.getUpdateProgress() + '%' }">
      </div>
    </div>
    {{ vm.updateCount }} / {{ vm.rosterSize }}
  </div>
</div>

<!-- Roster -->
<div class="row roster-wrapper fade" ng-show="vm.updating === false">
  <div class="col-md-9 roster-table-wrapper" style="border-right: 1px dashed #555;">
    <table class="table table-condensed table-hover roster-table">
    <thead>
      <tr>
        <th></th>
        <th></th>
        <th></th>
        <th><trmds-slot-icons slot="head" size="24"></trmds-slot-icons></th>
        <th><trmds-slot-icons slot="neck" size="24"></trmds-slot-icons></th>
        <th><trmds-slot-icons slot="shoulder" size="24"></trmds-slot-icons></th>
        <th><trmds-slot-icons slot="back" size="24"></trmds-slot-icons></th>
        <th><trmds-slot-icons slot="chest" size="24"></trmds-slot-icons></th>
        <th><trmds-slot-icons slot="wrist" size="24"></trmds-slot-icons></th>
        <th><trmds-slot-icons slot="hands" size="24"></trmds-slot-icons></th>
        <th><trmds-slot-icons slot="waist" size="24"></trmds-slot-icons></th>
        <th><trmds-slot-icons slot="legs" size="24"></trmds-slot-icons></th>
        <th><trmds-slot-icons slot="feet" size="24"></trmds-slot-icons></th>
        <th><trmds-slot-icons slot="finger1" size="24"></trmds-slot-icons></th>
        <th><trmds-slot-icons slot="finger2" size="24"></trmds-slot-icons></th>
        <th><trmds-slot-icons slot="trinket1" size="24"></trmds-slot-icons></th>
        <th><trmds-slot-icons slot="trinket2" size="24"></trmds-slot-icons></th>
        <th><trmds-slot-icons slot="mainHand" size="24"></trmds-slot-icons></th>
        <th><trmds-slot-icons slot="offHand" size="24"></trmds-slot-icons></th>
        <th></th>
        <th><img src="http://wow.zamimg.com/images/wow/icons/large/inv_jewelcrafting_70_saberseye.jpg" width="24" height="24" title="Gemmes" class="img-rounded"/></th>
        <th><img src="http://wow.zamimg.com/images/wow/icons/large/inv_enchanting_70_chaosshard.jpg" width="24" height="24" title="Enchants" class="img-rounded"/></th>
      </tr>
    </thead>
    <tbody>
      <tr ng-repeat="raider in vm.roster | orderBy:['+role', '+class', '-averageItemLevel']">
        <!-- Role -->
        <td style="text-align: left;">
          <trmds-role-icons role="{{ raider.role }}" size="24"></trmds-role-icons>
          <a ng-href="#/character/{{ raider.name }}" class="roster-raider-name" ng-class="vm.getClassColor(raider.class)">
            {{ raider.name }}
          </a>
        </td>
        <!-- ilvl -->
        <td ng-class="vm.getIlvlColor(raider.averageItemLevel)">{{ raider.averageItemLevel }}</td>
        <!-- Separator -->
        <td></td>
        <!-- Slots -->
        <td ng-repeat="item in raider.items" ng-class="vm.getItemQualityColor(item.quality)">
          {{ item.ilvl ? item.ilvl : ''}}
        </td>
        <!-- Separator -->
        <td></td>
        <!-- Gems -->
        <td ng-class="vm.getGemAuditColor(raider)">
          {{ raider.audit.equipedGems }}/{{ raider.audit.gemSlots }}
        </td>
        <!-- Enchants -->
        <td ng-class="raider.audit.missingEnchants > 0 ? 'roster-audit-bad' : 'roster-audit-good'">
          {{ 4 - raider.audit.missingEnchants }}/4
        </td>
      </tr>
    </tbody>
  </table>
  </div>

  <!-- Roster info -->
  <div class="col-md-3 fade" ng-show="vm.rosterInfos">
    <div class="row text-center">
      <div class="col-md-12">
        <h2>{{ vm.rosterInfos.size }} <small>Raiders</small></h2>

        <!-- Class Distribution -->
        <canvas class="chart chart-doughnut"
                chart-data="vm.classDistribution.data"
                chart-labels="vm.classDistribution.labels"
                chart-colors="vm.classDistribution.colors">
        </canvas>

        <!-- Ilvl - | ~ | + -->
        <h3 class="text-muted">ilvl</h3>
        <span class="roster-ilvl-lowest">{{ vm.rosterInfos.lowestItemLevel }}</span>
        <span class="roster-ilvl-average">{{ vm.rosterInfos.averageItemLevel }}</span>
        <span class="roster-ilvl-highest">{{ vm.rosterInfos.highestItemLevel }}</span>
      </div>

      <div class="col-md-12">
        <hr/>
      </div>

      <!-- Armor Types -->
      <h4>Armor types</h4>
      <div class="col-md-8">
        <canvas class="chart chart-pie"
                chart-data="vm.armorTypes.data"
                chart-labels="vm.armorTypes.labels"
                chart-colors="vm.armorTypes.colors">
        </canvas>
      </div>
      <div class="col-md-4">
        <div class="roster-armor-type roster-armor-type-plate"></div>
        <div class="roster-armor-type roster-armor-type-mail"></div>
        <div class="roster-armor-type roster-armor-type-leather"></div>
        <div class="roster-armor-type roster-armor-type-cloth"></div>
      </div>

      <!-- Armor Tokens -->
      <div class="col-md-12">
        <h4>Armor tokens</h4>
        <canvas class="chart chart-pie"
                chart-data="vm.armorTokens.data"
                chart-labels="vm.armorTokens.labels"
                chart-colors="vm.armorTokens.colors">
        </canvas>
      </div>

    </div>
  </div>

</div>
</div>
